package root;

import com.google.api.client.googleapis.auth.oauth2.GoogleIdToken;
import com.google.api.client.googleapis.auth.oauth2.GoogleIdToken.Payload;
import com.google.api.client.googleapis.auth.oauth2.GoogleIdTokenVerifier;


public class ValidateToken {
	GoogleIdTokenVerifier verifier = new GoogleIdTokenVerifier.Builder(transport, jsonFactory)
	.setAudience(Arrays.asList(CLIENT_ID))
	.build();

	//(Receive idTokenString by HTTPS POST)

	GoogleIdToken idToken = verifier.verify(idTokenString);
	if (idToken != null) {
	Payload payload = idToken.getPayload();
	if (payload.getHostedDomain().equals(APPS_DOMAIN_NAME)
	  // If multiple clients access the backend server:
	  && Arrays.asList(ANDROID_CLIENT_ID, IOS_CLIENT_ID).contains(payload.getAuthorizedParty())) {
	System.out.println("User ID: " + payload.getSubject());
	} else {
	System.out.println("Invalid ID token.");
	}
	} else {
	System.out.println("Invalid ID token.");
	}
}
